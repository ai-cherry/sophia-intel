{
  "estuary": {
    "api_base_url": "https://api.estuary.dev",
    "dashboard_url": "https://dashboard.estuary.dev",
    "tenant": "sophia-intel",
    "namespace": "sophia/",
    "authentication": {
      "jwt_token_env": "ESTUARY_JWT_TOKEN",
      "refresh_token_env": "ESTUARY_REFRESH_TOKEN",
      "token_expiry": "2025-08-28T12:00:00Z"
    },
    "captures": {
      "sophia_ai_data": {
        "description": "Main data capture for Sophia AI platform",
        "source": "HTTP API",
        "interval": "5m",
        "endpoint": "https://api.sophia-intel.ai/data/stream",
        "connector": "ghcr.io/estuary/source-http-ingest:dev",
        "bindings": [
          {
            "resource": {
              "stream": "sophia_data",
              "syncMode": "incremental"
            },
            "target": "sophia/sophia_raw_data"
          }
        ]
      },
      "sophia_agent_logs": {
        "description": "Capture agent interaction logs",
        "source": "File System",
        "interval": "1m",
        "path": "/var/log/sophia/agents/",
        "connector": "ghcr.io/estuary/source-file:dev"
      },
      "sophia_metrics": {
        "description": "Capture platform metrics and performance data",
        "source": "Prometheus",
        "interval": "30s",
        "endpoint": "http://localhost:9090/api/v1/query",
        "connector": "ghcr.io/estuary/source-prometheus:dev"
      }
    },
    "materializations": {
      "sophia_postgres": {
        "description": "PostgreSQL materialization for processed data",
        "target": "PostgreSQL",
        "schema": "estuary",
        "connector": "ghcr.io/estuary/materialize-postgres:dev",
        "config": {
          "host": "${POSTGRES_HOST}",
          "port": 5432,
          "database": "sophia",
          "schema": "estuary",
          "user": "${POSTGRES_USER}",
          "password": "${POSTGRES_PASSWORD}"
        },
        "bindings": [
          {
            "source": "sophia/sophia_raw_data",
            "resource": {
              "table": "sophia_processed_data"
            }
          }
        ]
      },
      "sophia_redis": {
        "description": "Redis materialization for real-time data",
        "target": "Redis",
        "connector": "ghcr.io/estuary/materialize-redis:dev",
        "config": {
          "host": "${REDIS_HOST}",
          "port": 6379,
          "password": "${REDIS_PASSWORD}",
          "database": 0
        }
      },
      "sophia_s3": {
        "description": "S3 materialization for data archival",
        "target": "AWS S3",
        "connector": "ghcr.io/estuary/materialize-s3:dev",
        "config": {
          "bucket": "sophia-intel-data",
          "region": "us-west-2",
          "prefix": "estuary/",
          "access_key_id": "${AWS_ACCESS_KEY_ID}",
          "secret_access_key": "${AWS_SECRET_ACCESS_KEY}"
        }
      }
    },
    "collections": {
      "sophia/sophia_raw_data": {
        "description": "Raw data collection from various sources",
        "schema": {
          "type": "object",
          "properties": {
            "timestamp": {
              "type": "string",
              "format": "date-time"
            },
            "source": {
              "type": "string"
            },
            "data": {
              "type": "object"
            },
            "metadata": {
              "type": "object"
            }
          },
          "required": ["timestamp", "source", "data"]
        }
      },
      "sophia/sophia_processed_data": {
        "description": "Processed and enriched data",
        "schema": {
          "type": "object",
          "properties": {
            "id": {
              "type": "string"
            },
            "timestamp": {
              "type": "string",
              "format": "date-time"
            },
            "source": {
              "type": "string"
            },
            "processed_data": {
              "type": "object"
            },
            "enrichments": {
              "type": "object"
            },
            "confidence_score": {
              "type": "number",
              "minimum": 0,
              "maximum": 1
            }
          },
          "required": ["id", "timestamp", "source", "processed_data"]
        }
      }
    },
    "transformations": {
      "sophia_data_enrichment": {
        "description": "Enrich raw data with AI insights",
        "source": "sophia/sophia_raw_data",
        "target": "sophia/sophia_processed_data",
        "sql": "SELECT *, CURRENT_TIMESTAMP as processed_at FROM sophia_raw_data WHERE data IS NOT NULL"
      }
    }
  }
}