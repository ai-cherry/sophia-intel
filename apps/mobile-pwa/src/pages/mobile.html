<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#6366f1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="SOPHIA Voice">
    
    <title>SOPHIA Voice Command Center</title>
    <meta name="description" content="AI-powered voice command interface for SOPHIA Intel platform">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="/manifest.json">
    
    <!-- Icons -->
    <link rel="icon" type="image/png" sizes="32x32" href="/icons/icon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/icons/icon-16x16.png">
    <link rel="apple-touch-icon" href="/icons/icon-180x180.png">
    
    <!-- Preload critical resources -->
    <link rel="preload" href="/mobile/app.css" as="style">
    <link rel="preload" href="/mobile/app.js" as="script">
    
    <!-- Styles -->
    <style>
        /* Critical CSS for immediate rendering */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #16213e 100%);
            color: #ffffff;
            height: 100vh;
            overflow: hidden;
            user-select: none;
            -webkit-user-select: none;
            -webkit-touch-callout: none;
        }
        
        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
            flex-direction: column;
        }
        
        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 3px solid rgba(99, 102, 241, 0.3);
            border-top: 3px solid #6366f1;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .loading-text {
            margin-top: 20px;
            font-size: 16px;
            color: #a0a0a0;
        }
    </style>
    
    <link rel="stylesheet" href="/mobile/app.css">
</head>
<body>
    <!-- Loading Screen -->
    <div id="loading-screen" class="loading">
        <div class="loading-spinner"></div>
        <div class="loading-text">Initializing SOPHIA Voice...</div>
    </div>
    
    <!-- Main App Container -->
    <div id="app" style="display: none;">
        <!-- Header -->
        <header class="app-header">
            <div class="header-content">
                <div class="sophia-logo">
                    <div class="logo-icon">ðŸŽ¤</div>
                    <div class="logo-text">
                        <div class="logo-title">SOPHIA</div>
                        <div class="logo-subtitle">Voice Command Center</div>
                    </div>
                </div>
                <div class="connection-status" id="connection-status">
                    <div class="status-indicator"></div>
                    <span class="status-text">Connected</span>
                </div>
            </div>
        </header>
        
        <!-- Main Voice Interface -->
        <main class="voice-interface">
            <!-- Voice Button Container -->
            <div class="voice-button-container">
                <button id="voice-button" class="voice-button" aria-label="Hold to speak">
                    <div class="voice-button-inner">
                        <div class="microphone-icon">
                            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"></path>
                                <path d="M19 10v2a7 7 0 0 1-14 0v-2"></path>
                                <line x1="12" y1="19" x2="12" y2="23"></line>
                                <line x1="8" y1="23" x2="16" y2="23"></line>
                            </svg>
                        </div>
                        <div class="voice-waves">
                            <div class="wave wave-1"></div>
                            <div class="wave wave-2"></div>
                            <div class="wave wave-3"></div>
                        </div>
                    </div>
                </button>
                
                <!-- Voice Status -->
                <div class="voice-status" id="voice-status">
                    <div class="status-text">Tap and hold to speak</div>
                    <div class="status-subtext">Release to send command</div>
                </div>
            </div>
            
            <!-- Audio Visualization -->
            <div class="audio-visualizer" id="audio-visualizer">
                <canvas id="visualizer-canvas" width="300" height="100"></canvas>
            </div>
        </main>
        
        <!-- Conversation History -->
        <section class="conversation-section">
            <div class="conversation-header">
                <h3>Conversation</h3>
                <button id="clear-conversation" class="clear-button" aria-label="Clear conversation">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M3 6h18"></path>
                        <path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"></path>
                        <path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"></path>
                    </svg>
                </button>
            </div>
            <div class="conversation-history" id="conversation-history">
                <div class="conversation-item system-message">
                    <div class="message-avatar">ðŸ¤–</div>
                    <div class="message-content">
                        <div class="message-text">Hi! I'm SOPHIA, your intelligent AI assistant. Hold the microphone button and speak your command.</div>
                        <div class="message-time">Just now</div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Quick Actions -->
        <section class="quick-actions">
            <div class="action-buttons">
                <button class="action-button" data-command="What's my schedule today?">
                    <div class="action-icon">ðŸ“…</div>
                    <div class="action-text">Schedule</div>
                </button>
                <button class="action-button" data-command="Show me system status">
                    <div class="action-icon">ðŸ“Š</div>
                    <div class="action-text">Status</div>
                </button>
                <button class="action-button" data-command="Help me with a task">
                    <div class="action-icon">ðŸ’¡</div>
                    <div class="action-text">Help</div>
                </button>
                <button class="action-button" data-command="What's the latest news?">
                    <div class="action-icon">ðŸ“°</div>
                    <div class="action-text">News</div>
                </button>
            </div>
        </section>
        
        <!-- Settings Panel -->
        <div class="settings-panel" id="settings-panel">
            <div class="settings-header">
                <h3>Voice Settings</h3>
                <button id="close-settings" class="close-button">Ã—</button>
            </div>
            <div class="settings-content">
                <div class="setting-item">
                    <label for="voice-sensitivity">Microphone Sensitivity</label>
                    <input type="range" id="voice-sensitivity" min="0.1" max="1.0" step="0.1" value="0.5">
                </div>
                <div class="setting-item">
                    <label for="auto-send">Auto-send after silence</label>
                    <input type="checkbox" id="auto-send" checked>
                </div>
                <div class="setting-item">
                    <label for="voice-feedback">Voice feedback</label>
                    <input type="checkbox" id="voice-feedback" checked>
                </div>
            </div>
        </div>
        
        <!-- Settings Button -->
        <button id="settings-button" class="settings-button" aria-label="Open settings">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="3"></circle>
                <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1 1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
            </svg>
        </button>
    </div>
    
    <!-- Error Modal -->
    <div id="error-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Connection Error</h3>
                <button id="close-error" class="close-button">Ã—</button>
            </div>
            <div class="modal-body">
                <p id="error-message">Unable to connect to SOPHIA voice services.</p>
                <div class="error-actions">
                    <button id="retry-connection" class="retry-button">Retry Connection</button>
                    <button id="use-text-mode" class="text-mode-button">Use Text Mode</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Install Prompt -->
    <div id="install-prompt" class="install-prompt" style="display: none;">
        <div class="install-content">
            <div class="install-icon">ðŸ“±</div>
            <div class="install-text">
                <div class="install-title">Install SOPHIA Voice</div>
                <div class="install-subtitle">Add to your home screen for quick access</div>
            </div>
            <div class="install-actions">
                <button id="install-app" class="install-button">Install</button>
                <button id="dismiss-install" class="dismiss-button">Later</button>
            </div>
        </div>
    </div>
    
    <!-- Scripts -->
    <script src="/mobile/app.js"></script>
    
    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/service-worker.js')
                    .then((registration) => {
                        console.log('SOPHIA Voice: Service Worker registered successfully');
                    })
                    .catch((error) => {
                        console.error('SOPHIA Voice: Service Worker registration failed:', error);
                    });
            });
        }
    </script>
</body>
</html>

